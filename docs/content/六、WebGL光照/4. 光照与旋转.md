# 4. 光照与旋转

经过前面三节的学习与实战，相信大家对光照已经有所了解了，并且也知道平行光、环境光、点光源的一些光照效果了。但是不知道在之前的学习中你有没有想过一个**法向量相关**的问题，法向量在不断变化中的光照效果应该如何处理？

大家都知道，求点光源、平行光的**反射光颜色都跟法向量**有关（求入射光的夹角），但是之前的物体都是静止的。如果说现在有一个物体会有一个**自转**的动画，这个时候还按照之前的方式求反射光颜色还是我们预期的效果吗？

## 物体发生旋转会怎么样

其实我们大概可以猜出，当物体旋转时（以立方体为例），其中的某几个面的法向量是一直都在发生改变的。这样一来，再按照之前的反射光计算公式直接计算的话，可能就不是我们预期的效果了。

光说是不行的，我们直接通过一个实际的案例来看看效果会怎么样吧。这里我接着沿用上一节的实战案例——点光源的光照效果，并且在其基础上，给物体新增一个旋转的动画效果。

关于变换效果大家应该都很熟悉了，原理就是将**顶点坐标左乘旋转矩阵**即可，并且在当前这么多库的基础上，我们直接调`api`就行了。简单地看看实现代码：

```js
const animation = () => {
  // 设置绕 y 轴旋转，每次旋转 1 度
  baseMvpMatrix.rotate(1, 0, 1, 0)
  // 将新计算的 mvp 矩阵传入缓冲区
  gl.uniformMatrix4fv(u_MvpMatrix, false, baseMvpMatrix.elements)
  // 清除缓冲区数据
  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)
  // 重新绘制
  gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_BYTE, 0)
  animationId = requestAnimationFrame(animation)
}
```

其实代码并不复杂，写了了一个基于 `requestAnimationFrame` 的运动函数，每次执行的时候会绕`y`轴顺时针旋转`1`度。直接通过示例程序看看效果吧：

:::demo
sixth/4_1
:::
